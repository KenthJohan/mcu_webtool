<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCU Flash Page Viewer (2kB)</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <h1>MCU Flash Page Viewer (2kB - 64x32 Grid)</h1>

    <div class="container">

        <div class="left-panel">
            <div id="info">
                Page Base Address: <span class="address-display">0x0800F800</span> |
                Size: 2048 bytes (2kB) |
                Click on grid to view address
            </div>
            <canvas id="gridCanvas"></canvas>
            <div id="cellInfo">Click on grid to see address information</div>
        </div>

        <div class="right-panel">
            <h3>Parameters in this Page</h3>
            <div id="parameterList">Loading...</div>


        <h2>Add Parameter</h2>
        <form id="parameterForm">
            <div class="form-group">
                <label>Parameter Name:</label>
                <input type="text" id="paramName" name="name" required placeholder="e.g., CONFIG_TIMEOUT">
            </div>

            <div class="form-group">
                <label>Type:</label>
                <select id="paramType" name="type_id" required>
                    <option value="">Select Type</option>
                </select>
            </div>

            <div class="form-group">
                <label>Quantity:</label>
                <select id="paramQuantity" name="quantity_id">
                    <option value="">Select Quantity</option>
                </select>
            </div>

            <div class="form-group">
                <label>Unit:</label>
                <select id="paramUnit" name="unit_id">
                    <option value="">Select Unit</option>
                </select>
            </div>

            <div class="form-group">
                <label>Array Count:</label>
                <input type="number" id="paramCount" name="count" value="1" min="1" required>
            </div>

            <div class="form-group">
                <label>Size (bytes):</label>
                <input type="number" id="paramSize" name="size" value="4" min="1" max="2048" required readonly>
            </div>

            <div class="form-group">
                <label>Offset in Page:</label>
                <input type="number" id="paramOffset" name="offset" value="0" min="0" max="2047" required readonly>
            </div>

            <div class="form-group">
                <label>Description:</label>
                <textarea id="paramDescription" name="description" placeholder="Parameter description"></textarea>
            </div>

            <button type="button" class="secondary" onclick="gridCanvas.startSelection()">Select on Grid</button>
            <button type="submit">Add Parameter</button>
            <button type="button" class="danger" onclick="gridCanvas.clearSelection()">Clear</button>
        </form>
        </div>
    </div>



    <div id="selectionMode" class="selection-mode" style="display: none;">
        <strong>Selection Mode Active</strong><br>
        Click and drag on the grid to select parameter location
    </div>


    <script src="FlashPageGridCanvas.js"></script>
    <script>
        // Initialize the grid canvas
        const gridCanvas = new FlashPageGridCanvas('gridCanvas', {
            pageBaseAddress: 0x08003000,
            apiPath: 'api/select.php'
        });
        
        // Initialize when DOM is ready
        gridCanvas.init();
    </script>
</body>

</html>